<!DOCTYPE html>
<html>
<head>
    <title>Test Multiple Diagnosis Functionality</title>
    <style>
        body { 
            font-family: Arial, sans-serif; 
            margin: 20px; 
            background: #f8f9fa;
        }
        .container {
            max-width: 800px;
            margin: 0 auto;
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .form-group {
            margin-bottom: 20px;
        }
        .form-label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            color: #333;
        }
        .diagnosis-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 8px;
            margin-bottom: 12px;
            padding: 12px;
            background: #f8f9fa;
            border-radius: 6px;
            border: 1px solid #e9ecef;
            min-height: 50px;
        }
        .diagnosis-tag {
            display: flex;
            align-items: center;
            background: #fff3cd;
            color: #856404;
            padding: 6px 12px;
            border-radius: 16px;
            font-size: 14px;
            font-weight: 500;
            border: 1px solid #ffeaa7;
            box-shadow: 0 1px 2px rgba(0,0,0,0.05);
        }
        .diagnosis-tag .remove-btn {
            background: transparent;
            border: none;
            color: #856404;
            cursor: pointer;
            font-size: 16px;
            font-weight: bold;
            padding: 0;
            margin-left: 8px;
            display: flex;
            align-items: center;
            justify-content: center;
            width: 16px;
            height: 16px;
            border-radius: 50%;
            transition: all 0.2s ease;
        }
        .diagnosis-tag .remove-btn:hover {
            background: #dc3545;
            color: white;
        }
        .diagnosis-input-group {
            display: flex;
            gap: 8px;
            align-items: center;
        }
        .diagnosis-input {
            flex: 1;
            padding: 10px 12px;
            border: 1px solid #ddd;
            border-radius: 6px;
            font-size: 14px;
        }
        .add-btn {
            background: #28a745;
            color: white;
            border: none;
            border-radius: 6px;
            padding: 10px 16px;
            cursor: pointer;
            font-size: 14px;
            font-weight: 500;
            transition: all 0.2s ease;
            min-width: 80px;
        }
        .add-btn:disabled {
            background: #6c757d;
            cursor: not-allowed;
        }
        .add-btn:hover:not(:disabled) {
            background: #218838;
        }
        .legacy-section {
            margin-top: 16px;
            padding-top: 16px;
            border-top: 1px solid #e9ecef;
        }
        .legacy-label {
            font-size: 12px;
            color: #6c757d;
            margin-bottom: 4px;
        }
        .prescription-display {
            margin-top: 20px;
            padding: 16px;
            background: #e3f2fd;
            border-radius: 6px;
            border: 1px solid #bbdefb;
        }
        .prescription-display h3 {
            margin: 0 0 12px 0;
            color: #1976d2;
        }
        .prescription-display p {
            margin: 4px 0;
            color: #333;
        }
        .toast {
            position: fixed;
            top: 20px;
            right: 20px;
            padding: 12px 16px;
            border-radius: 6px;
            color: white;
            font-weight: 500;
            z-index: 1000;
            animation: slideIn 0.3s ease;
        }
        .toast.success { background: #28a745; }
        .toast.warning { background: #ffc107; color: #333; }
        .toast.info { background: #17a2b8; }
        @keyframes slideIn {
            from { transform: translateX(100%); opacity: 0; }
            to { transform: translateX(0); opacity: 1; }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>Multiple Diagnosis Functionality Test</h1>
        <p>This demonstrates the multiple diagnosis feature similar to HealthPlix EMR.</p>
        
        <div class="form-group">
            <label class="form-label">Diagnosis</label>
            
            <!-- Diagnosis Tags Display -->
            <div id="diagnosisTags" class="diagnosis-tags">
                <!-- Tags will be dynamically added here -->
            </div>
            
            <!-- Diagnosis Input -->
            <div class="diagnosis-input-group">
                <input 
                    type="text" 
                    id="diagnosisInput" 
                    class="diagnosis-input" 
                    placeholder="Enter diagnosis and press Enter or click Add"
                />
                <button id="addBtn" class="add-btn" onclick="addDiagnosis()">
                    Add
                </button>
            </div>
            
            <!-- Legacy Single Diagnosis -->
            <div class="legacy-section">
                <label class="legacy-label">Legacy Diagnosis (Single)</label>
                <input 
                    type="text" 
                    id="legacyDiagnosis" 
                    class="diagnosis-input" 
                    placeholder="Enter single diagnosis (legacy field)"
                />
            </div>
        </div>
        
        <!-- Prescription Display -->
        <div class="prescription-display">
            <h3>Prescription Preview</h3>
            <p><strong>Diagnoses:</strong> <span id="diagnosisDisplay">None</span></p>
            <p><strong>Legacy Diagnosis:</strong> <span id="legacyDisplay">None</span></p>
            <p><strong>Total Diagnoses:</strong> <span id="countDisplay">0</span></p>
        </div>
    </div>

    <script>
        let diagnoses = [];
        let diagnosisInput = document.getElementById('diagnosisInput');
        let addBtn = document.getElementById('addBtn');
        let diagnosisTags = document.getElementById('diagnosisTags');
        let diagnosisDisplay = document.getElementById('diagnosisDisplay');
        let legacyDisplay = document.getElementById('legacyDisplay');
        let countDisplay = document.getElementById('countDisplay');
        let legacyDiagnosis = document.getElementById('legacyDiagnosis');

        function showToast(message, type = 'success') {
            const toast = document.createElement('div');
            toast.className = `toast ${type}`;
            toast.textContent = message;
            document.body.appendChild(toast);
            
            setTimeout(() => {
                toast.remove();
            }, 3000);
        }

        function addDiagnosis() {
            const input = diagnosisInput.value.trim();
            if (!input) return;
            
            if (diagnoses.includes(input)) {
                showToast('This diagnosis has already been added', 'warning');
                return;
            }
            
            diagnoses.push(input);
            diagnosisInput.value = '';
            updateDisplay();
            showToast(`${input} has been added to the prescription`, 'success');
        }

        function removeDiagnosis(diagnosis) {
            diagnoses = diagnoses.filter(d => d !== diagnosis);
            updateDisplay();
            showToast(`${diagnosis} has been removed from the prescription`, 'info');
        }

        function updateDisplay() {
            // Update tags
            diagnosisTags.innerHTML = '';
            diagnoses.forEach(diagnosis => {
                const tag = document.createElement('div');
                tag.className = 'diagnosis-tag';
                tag.innerHTML = `
                    <span>${diagnosis}</span>
                    <button class="remove-btn" onclick="removeDiagnosis('${diagnosis}')" title="Remove diagnosis">Ã—</button>
                `;
                diagnosisTags.appendChild(tag);
            });
            
            // Update prescription display
            diagnosisDisplay.textContent = diagnoses.length > 0 ? diagnoses.join(', ') : 'None';
            legacyDisplay.textContent = legacyDiagnosis.value || 'None';
            countDisplay.textContent = diagnoses.length;
            
            // Update add button state
            addBtn.disabled = !diagnosisInput.value.trim();
        }

        // Event listeners
        diagnosisInput.addEventListener('input', updateDisplay);
        diagnosisInput.addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                e.preventDefault();
                addDiagnosis();
            }
        });
        legacyDiagnosis.addEventListener('input', updateDisplay);

        // Initialize
        updateDisplay();
    </script>
</body>
</html>
